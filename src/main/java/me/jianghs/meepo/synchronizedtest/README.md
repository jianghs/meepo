# synchronized

## 何时产生线程安全问题？

多个线程访问同一资源时，会导致程序出现意想不到的结果。

同一资源指临界资源或者称为共享资源

## 如何解决？

同步互斥访问

## synchronized 原理

每个对象拥有一个锁标记（monitor）,也称为监视器。多个线程访问某个对象时，只有获得该对象锁标记的线程才能访问。

## 同步方法

* 一个线程正在访问synchronized修饰的方法时，其他线程不能访问其他synchronized修饰的方法。因为一个对象只有一把锁。
* 一个线程正在访问synchronized修饰的方法时，其他线程可以访问其他没有被synchronized修饰的方法。
* 出现异常时，锁自动释放

## 同步代码块

* 不在同步代码块中的内容为异步执行
* 多个线程调用synchronized(this)代码块时同步
* 调用synchronized(this)的线程和调用synchronized(x)的线程异步，x一般为方法参数或者实例对象
* 调用synchronized(x)的线程和调用x中同步方法的线程同步。
* 调用synchronized(x)的线程和调用x中synchronized(this)的线程同步。
* x不能为Strig的原因：

    由于字符串常量池，2个String对象中的字符串对象指向的是常量池中同一个内存区域，故2个加锁方法会彼此影响
    
## 同步静态方法 和 同步代码块使用类锁

都是锁住整个类，和使用对象锁的线程运行时是异步的。